{% extends 'base.html' %}
{% block content %}
<section class="section-header tasks-hero">
  <div class="hero-left">
    <h1 class="page-title">ML TaskGrid</h1>
    <div class="hero-actions">
      <form method="post" action="/run-pipeline" class="inline-form">
        <label class="input-label" for="ticker-input">Ticker</label>
        <div class="input-row">
          <input id="ticker-input" name="ticker" value="{{ ticker or 'AAPL' }}" placeholder="AAPL" />
          <button class="btn btn-primary" type="submit">Run Pipeline</button>
        </div>
      </form>
    </div>
  </div>
  <div class="hero-right">
    <div class="stat-card">
      <div class="stat-header">
        <span class="stat-title">Current Ticker</span>
        <span class="stat-pill live">Live</span>
      </div>
      <div class="stat-value">{{ ticker or 'AAPL' }}</div>
    </div>
    {% if ran %}
    <div class="stat-card success">
      <div class="stat-header">
        <span class="stat-title">Last Pipeline</span>
        <span class="stat-pill success">Complete</span>
      </div>
      <div class="stat-details">Saved to <code>ml/registry/{{ ticker or 'AAPL' }}/{{ ts or '...' }}</code></div>
    </div>
    {% else %}
    <div class="stat-card muted-card">
      <div class="stat-header">
        <span class="stat-title">Last Pipeline</span>
        <span class="stat-pill queued">Queued</span>
      </div>
      <div class="stat-details">Run to refresh artifacts</div>
    </div>
    {% endif %}
  </div>
</section>

<section class="tasks-grid">
  <article class="card task-card">
    <div class="card-head">
      <span class="pill">Signals</span>
      <h3>Single Classification</h3>
    </div>
    <p>Classifies whether the stock price will go up or down the next day. Employs XGBoost classification with features derived from historical stock data.</p>
    <div class="form-actions"><a class="btn btn-primary" href="/classify{% if ticker %}?ticker={{ ticker }}{% endif %}">Open</a></div>
  </article>
  <article class="card task-card">
    <div class="card-head">
      <span class="pill">Next 7 Day Return</span>
      <h3>Regression</h3>
    </div>
    <p>Predict next 7 days return for a selected ticker using the pipelineâ€‘ingested feature dataset. The regression page computes predictions (by default for the latest week of data).</p>
    <div class="form-actions"><a class="btn btn-primary" href="/upload{% if ticker %}?ticker={{ ticker }}{% if ts %}&ts={{ ts }}{% endif %}{% endif %}">Open</a></div>
  </article>
  <article class="card task-card">
    <div class="card-head">
      <span class="pill">Time Series</span>
      <h3>Forecast</h3>
    </div>
    <p>Predicts future stock prices using ARIMA (AutoRegressive Integrated Moving Average) models. Provides forecasts along with confidence intervals for the specified horizon.</p>
    <div class="form-actions"><a class="btn btn-primary" href="/forecast-page{% if ticker %}?ticker={{ ticker }}{% endif %}">Open</a></div>
  </article>
  <article class="card task-card">
    <div class="card-head">
      <span class="pill">Neighbors</span>
      <h3>Recommend</h3>
    </div>
    <p>Find nearest neighbors in PCA space by reference date or custom vector.</p>
    <div class="form-actions"><a class="btn btn-primary" href="/recommend-page{% if ticker %}?ticker={{ ticker }}{% endif %}">Open</a></div>
  </article>
  <article class="card task-card">
    <div class="card-head">
      <span class="pill">Patterns</span>
      <h3>Association</h3>
    </div>
    <p>Identifies frequent patterns and associations in stock data, such as price movements and volume trends. Uses the Apriori algorithm to generate rules based on support and confidence thresholds.</p>
    <div class="form-actions"><a class="btn btn-primary" href="/association-page{% if ticker %}?ticker={{ ticker }}{% endif %}">Open</a></div>
  </article>
  <article class="card task-card">
    <div class="card-head">
      <span class="pill">Insight</span>
      <h3>Dimensionality Reduction</h3>
    </div>
    <p>Reduces the dimensionality of stock features while retaining the most significant information. Outputs transformed features and explained variance ratios for analysis.</p>
    <div class="form-actions"><a class="btn btn-primary" href="/pca{% if ticker %}?ticker={{ ticker }}{% endif %}">Open</a></div>
  </article>
  <article class="card task-card">
    <div class="card-head">
      <span class="pill">Segments</span>
      <h3>Clustering</h3>
    </div>
    <p>Groups stocks into clusters based on similar feature patterns. Applies KMeans clustering to identify distinct market behaviors or stock groupings.</p>
    <div class="form-actions"><a class="btn btn-primary" href="/cluster{% if ticker %}?ticker={{ ticker }}{% endif %}">Open</a></div>
  </article>
</section>
{% endblock %}